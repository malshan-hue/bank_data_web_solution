@using bank_data_web_models
@using bank_data_web_application.Helpers

@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@model User

@{
	Layout = "~/Views/Shared/_UserDashboardLayout.cshtml";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<div class="container-fluid p-0">

	<div class="mb-3">
		<h1 class="h3 d-inline align-middle">Profile</h1>
	</div>

	<div class="row">
		<div class="col-md-4 col-xl-3">
			<div class="card mb-3">
				<div class="card-header">
					<h5 class="card-title mb-0">Profile Details</h5>
				</div>
				<div class="card-body text-center">
					<img src="@GlobalStaticHelper.baseApiUrl@Model.UserInformation.PictureUrl" alt="Christina Mason" class="img-fluid rounded-circle mb-2" width="128" height="128" />
					<h5 class="card-title mb-0">@Model.UserInformation.Name</h5>
					<div class="text-muted mb-2">User</div>

					<div>
						<a class="btn btn-primary btn-sm" href="#">Active</a>
					</div>
				</div>
			</div>
		</div>

		<div class="col-md-8 col-xl-9">
			<div class="card">

				<div class="card-header">
					<h5 class="card-title mb-0">Update Details</h5>
				</div>

				<div class="card-body h-100">

					<form asp-action="Profile" asp-controller="BankApplicationHome" id="profile-form" method="post" data-ajax="true" data-ajax-begin="updateProfileBegin" data-ajax-complete="updateProfileComplete" data-ajax-failure="updateProfileFailure" enctype="multipart/form-data">
						@Html.HiddenFor(e => e.UserId)
						@Html.HiddenFor(e => e.Password)
						<div class="row mb-4">
							<div class="col-6">
								<label asp-for="UserName" class="form-label">User Name</label>
								<input type="text" class="form-control" asp-for="UserName" name="UserName" placeholder="UserName">
							</div>
							<div class="col-6">
								<label asp-for="Password" class="form-label">Password</label>
								<input type="text" class="form-control" name="Password" placeholder="New Password">
							</div>
						</div>

						<div class="row mb-4">
							<div class="col-6">
								<label asp-for="UserInformation.Name" class="form-label">Name</label>
								<input type="text" class="form-control" asp-for="UserInformation.Name" name="Name" placeholder="Name">
							</div>
							<div class="col-6">
								<label asp-for="UserInformation.Email" class="form-label">Email</label>
								<input type="text" class="form-control" asp-for="UserInformation.Email" name="Email" placeholder="Email">
							</div>
						</div>

						<div class="row mb-4">
							<div class="col-6">
								<label asp-for="UserInformation.Phone" class="form-label">Phone</label>
								<input type="text" class="form-control" asp-for="UserInformation.Phone" name="Phone" placeholder="Phone">
							</div>
							<div class="col-6">
								<label asp-for="UserInformation.Picture" class="form-label">Picture</label>
								<input type="file" class="form-control" asp-for="UserInformation.Picture" name="Picture" placeholder="Picture" />
							</div>
						</div>

						<div class="row mb-4">
							<div class="col-12">
								<button class="btn btn-lg btn-primary" type="submit">Save</button>
							</div>
						</div>
					
					</form>

				</div>

			</div>
		</div>
	</div>

</div>

@section Scripts{

	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
	<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>
	<script src="~/lib/jquery-ajax-unobtrusive/dist/jquery.unobtrusive-ajax.js"></script>

	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>

	<script type="text/javascript">

		var updateProfileBegin = function() {
			Swal.fire({
				title: 'Submitting your profile...',
				allowOutsideClick: false,
				didOpen: () => {
					Swal.showLoading();
				}
			});
		}

		var updateProfileComplete = function (response) {
			Swal.fire({
				icon: 'success',
				title: 'Profile Updated!',
				text: 'Your profile has been successfully updated.',
				confirmButtonText: 'OK'
			});

			location.reload();
		}

		var  updateProfileFailure = function (xhr, status, error) {
			Swal.fire({
				icon: 'error',
				title: 'Update Failed',
				text: 'Error updating profile: ' + error,
				confirmButtonText: 'Try Again'
			});
		}

	</script>
}